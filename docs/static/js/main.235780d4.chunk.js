(this["webpackJsonplist-tree"]=this["webpackJsonplist-tree"]||[]).push([[0],{137:function(e,t){},138:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(11),i=n.n(r),c=n(48),o=n(7),s="companies/COMPANIES_REQUEST",u="companies/COMPANIES_SUCCESS",l="companies/COMPANIES_FAILURE",d="housing/HOUSING_REQUEST",p="housing/HOUSING_SUCCESS",j="housing/HOUSING_FAILURE",b="clients/CLIENT_ADD",f="clients/CLIENT_DELETE",O="clients/CLIENT_REQUEST",m="clients/CLIENT_FAILURE",h="options/OPTION_MENU_OPEN",g="options/OPTION_SET_COMPANY",x="options/OPTION_CLIENT_PANEL",y="options/OPTION_SET_FLAT",v={data:[],dataOriginal:[],loading:!1,error:null},N={data:[],loading:!0,error:null},w={loading:!0,error:null},I={menuOpen:!0,curCompany:null,curFlat:null,clientPanel:!1},S=Object(c.b)({housing:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case d:return Object(o.a)(Object(o.a)({},e),{},{data:[],dataOriginal:[],loading:!0,error:null});case p:return Object(o.a)(Object(o.a)({},e),{},{data:a.data,dataOriginal:a.dataOriginal,loading:!1,error:null});case j:return Object(o.a)(Object(o.a)({},e),{},{data:[],dataOriginal:[],loading:!1,error:a});default:return e}},companies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case s:return Object(o.a)(Object(o.a)({},e),{},{data:[],loading:!0,error:null});case u:return Object(o.a)(Object(o.a)({},e),{},{data:a,loading:!1,error:null});case l:return Object(o.a)(Object(o.a)({},e),{},{data:[],loading:!1,error:a});default:return e}},clients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case b:case f:return Object(o.a)(Object(o.a)({},e),{},{loading:!1,error:null});case O:return Object(o.a)(Object(o.a)({},e),{},{loading:!0,error:null});case m:return Object(o.a)(Object(o.a)({},e),{},{loading:!1,error:a});default:return e}},options:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case h:return Object(o.a)(Object(o.a)({},e),{},{menuOpen:a});case g:return Object(o.a)(Object(o.a)({},e),{},{curCompany:a});case x:return Object(o.a)(Object(o.a)({},e),{},{clientPanel:a});case y:return Object(o.a)(Object(o.a)({},e),{},{curFlat:a});default:return e}}}),C=n(80),k=Object(c.c)(S,Object(c.a)(C.a)),E=n(18),_=n(183),L=n(184),T=n(185),A=n(181),P=n(87),B=n.n(P),H=n(182),R=n(195),U=n(177),W=Object(U.a)((function(e){return{root:{display:"flex",minHeight:"100vh"}}})),D=320,F=Object(U.a)((function(e){return{root:Object(o.a)(Object(o.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"space-between",textAlign:"center"})}})),G=Object(U.a)((function(e){return{title:{fontSize:"1.5rem",margin:0,padding:e.spacing(0,1)},drawer:{width:D,flexShrink:0},drawerPaper:{width:D},list:{textAlign:"center"},loader:{margin:e.spacing(3)}}})),M=n(186),q=n(26),z=n.n(q),J=n(49),Q=n(50),V=n.n(Q),Y="https://dispex.org/api/vtest/",K={get:function(){var e=Object(J.a)(z.a.mark((function e(t,n,a){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.a.get(Y+t).then((function(e){e&&200===e.status&&n(e)})).catch((function(e){a(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),post:function(){var e=Object(J.a)(z.a.mark((function e(t,n,a,r){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.a.post(Y+t,n).then((function(e){e&&200===e.status&&a(e)})).catch((function(e){r(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),put:function(){var e=Object(J.a)(z.a.mark((function e(t,n,a,r){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.a.put(Y+t,n).then((function(e){e&&200===e.status&&a(e)})).catch((function(e){r(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),del:function(){var e=Object(J.a)(z.a.mark((function e(t,n,a){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.a.delete(Y+t).then((function(e){e&&200===e.status&&n(e)})).catch((function(e){a(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},X=function(){return function(e){e({type:s}),K.get("Request/companies",(function(t){var n=t.data;e(function(e){return{type:u,payload:e}}(n))}),(function(t){e(function(e){return{type:l,payload:e}}(t))}))}},Z=n(92),$=n(85),ee=n(86),te=n.n(ee),ne=function(e){return function(t){t({type:d}),K.get("HousingStock?companyId=".concat(e),(function(e){var n=e.data;t(function(e,t){return{type:p,payload:{data:e,dataOriginal:t}}}(function(e){var t,n=[],a=Object($.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,i=r.streetName,c=r.building,o=r.flat,s=r.clients,u=r.addressId,l=r.houseId,d=r.streetId;n=[].concat(Object(Z.a)(n),[{id:d,name:"\u0423\u043b\u0438\u0446\u0430 ".concat(i),parent:0},{id:l,name:"\u0414\u043e\u043c ".concat(c),parent:d},{name:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430 ".concat(o),parent:l,addressId:u,clients:s}])}}catch(p){a.e(p)}finally{a.f()}return n=Array.from(new Set(n.map(JSON.stringify))).map(JSON.parse),(n=new te.a(n,{key_id:"id",key_parent:"parent"})).GetTree()}(n),n))}),(function(e){t(function(e){return{type:j,payload:e}}(e))}))}},ae=function(e){return{type:h,payload:e}},re=n(4),ie=function(e){return function(t){var n=Object(E.c)((function(e){return e})),r=n.companies.data,i=n.options,c=i.menuOpen,s=i.curCompany,u=Object(E.b)();Object(a.useEffect)((function(){u(X())}),[]);var l=function(){u(ae(!1))},d=Object(o.a)(Object(o.a)({},t),{},{menuOpen:c,data:r,loadHousing:function(e){l(),s!==e&&(u(ne(e)),u({type:g,payload:e}))},handleDrawerClose:l});return Object(re.jsx)(e,Object(o.a)({},d))}}((function(e){var t=e.menuOpen,n=e.data,a=e.loadHousing,r=e.handleDrawerClose,i=G();return Object(re.jsxs)(R.a,{className:i.drawer,variant:"persistent",anchor:"left",open:t,classes:{paper:i.drawerPaper},children:[Object(re.jsxs)("div",{className:F().root,children:[Object(re.jsx)("h1",{className:i.title,children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0423\u041a"}),Object(re.jsx)(A.a,{onClick:r,children:Object(re.jsx)(B.a,{})})]}),Object(re.jsx)(H.a,{}),Object(re.jsx)(_.a,{component:"nav",className:"".concat(i.list),"aria-label":"mailbox folders",children:n&&n.length?n.map((function(e){return Object(re.jsx)(L.a,{button:!0,onClick:function(){return a(e.id)},children:Object(re.jsx)(T.a,{primary:e.name})},e.id)})):Object(re.jsx)(M.a,{className:"".concat(i.loader),color:"inherit"})})]})})),ce=n(17),oe=n(3),se=Object(U.a)((function(e){return{content:Object(ce.a)({flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-320},e.breakpoints.down("sm"),{padding:e.spacing(2)}),contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},contentWrapper:Object(ce.a)({display:"flex",justifyContent:"space-between",flexWrap:"wrap"},e.breakpoints.down("sm"),{height:"100vh"}),tree:Object(ce.a)({flexGrow:1,flexShrink:0,paddingRight:"16px !important",maxWidth:400},e.breakpoints.down("sm"),{height:"30%",overflow:"auto",maxWidth:"100%",marginBottom:"20px"})}})),ue=n(196),le=n(189),de=n(89),pe=n.n(de),je=n(90),be=n.n(je),fe=n(197),Oe=Object(U.a)((function(e){return{root:Object(ce.a)({maxWidth:"calc(100% - ".concat(400,"px)"),minWidth:"280px",minHeight:"calc(100vh - 88px*2)",borderLeft:"1px solid lightgrey",paddingLeft:"16px",flexGrow:1},e.breakpoints.down("sm"),{maxWidth:"100%",borderLeft:0,borderTop:"1px solid lightgrey",paddingLeft:0}),info:{width:"100%",padding:e.spacing(2,0),borderBottom:"1px solid lightgrey"},title:{margin:0},clientsList:{padding:e.spacing(2,0)},paper:{position:"relative",padding:e.spacing(1),paddingRight:40},listItem:{position:"relative",padding:e.spacing(0,1)},key:{flexGrow:0,flexShrink:0,marginRight:10,"& span":{fontSize:"0.9rem",color:"grey"}},itemDelete:{position:"absolute",right:0,top:0,width:40,height:40,cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center","& *":{color:"grey",cursor:"pointer",fontSize:"2rem"}},form:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:0,flexWrap:"wrap","& *":Object(ce.a)({margin:5,flexGrow:1,maxWidth:320},e.breakpoints.down("sm"),{margin:0,marginRight:5})},btn:Object(ce.a)({maxWidth:"initial"},e.breakpoints.down("sm"),{marginTop:15})}})),me=n(188),he=n(139),ge=n(88),xe=n.n(ge),ye=n(193),ve=n(187),Ne=n(61),we=function(){return{type:O}},Ie=function(e){return{type:m,payload:e}},Se=function(e,t,n){return function(a){a(we()),K.post("HousingStock/client",e,(function(e){K.put("HousingStock/bind_client",{AddressId:t,ClientId:e.data.id},(function(e){a({type:b}),n()}),(function(e){a(Ie(e))}))}),(function(e){a(Ie(e))}))}},Ce=function(e,t){return function(n){n(we()),K.del("HousingStock/bind_client/".concat(e),(function(e){n({type:f}),t()}),(function(e){n(Ie(e))}))}},ke={setSameBlockHeight:function(e){ke.runByEvent((function(){var t,n;n=e,t=[].map.call(n,(function(e){return e.children[0]}));for(var a=0,r=0;r<t.length;++r)t[r].removeAttribute("style"),a=Math.max(a,t[r].offsetHeight);for(var i=0;i<t.length;++i)t[i].style.height=a+"px"}),["resize"])},runByEvent:function(e,t){e(),t.map((function(t){window.addEventListener(t,(function(){e()}))}))}},Ee=ke,_e=function(e){return function(t){var n=Object(E.c)((function(e){return e})),r=n.housing.dataOriginal,i=n.options,c=i.curFlat,s=i.curCompany,u=Object(a.useRef)(null),l=Object(E.b)(),d=Object(a.useState)(""),p=Object(Ne.a)(d,2),j=p[0],b=p[1],f=Object(a.useState)(""),O=Object(Ne.a)(f,2),m=O[0],h=O[1],g=Object(a.useState)(""),x=Object(Ne.a)(g,2),y=x[0],v=x[1],N=Object(a.useMemo)((function(){return c&&r.length?r.filter((function(e){return c===e.addressId}))[0]:null}),[s,c,r]);Object(a.useEffect)((function(){u.current&&Ee.setSameBlockHeight(u.current.children)}),[N]);var w=Object(o.a)(Object(o.a)({},t),{},{addressInfo:N,name:j,setName:b,phone:m,setPhone:h,email:y,setEmail:v,refLink:u,addClient:function(e){j&&m&&y&&(l(Se({name:j,phone:m,email:y},e,(function(){return l(ne(s))}))),b(""),h(""),v(""))},itemDelete:function(e){l(Ce(e,(function(){return l(ne(s))})))}});return Object(re.jsx)(e,Object(o.a)({},w))}}((function(e){var t=e.addressInfo,n=e.name,a=e.setName,r=e.phone,i=e.setPhone,c=e.email,o=e.setEmail,s=e.refLink,u=e.addClient,l=e.itemDelete,d=Oe();return t?Object(re.jsxs)("div",{className:d.root,children:[Object(re.jsx)("div",{className:d.info,children:Object(re.jsx)("h3",{className:d.title,children:"\u0443\u043b. ".concat(t.streetName," ").concat(t.building,", \u043a\u0432. ").concat(t.flat)})}),Object(re.jsxs)("div",{children:[Object(re.jsxs)("form",{className:"".concat(d.info," ").concat(d.form),noValidate:!0,autoComplete:"off",children:[Object(re.jsx)(ye.a,{required:!0,id:"name",label:"name",value:n,onChange:function(e){return a(e.target.value)}}),Object(re.jsx)(ye.a,{required:!0,id:"phone",label:"phone",value:r,onChange:function(e){return i(e.target.value)}}),Object(re.jsx)(ye.a,{required:!0,id:"email",label:"email",value:c,onChange:function(e){return o(e.target.value)}}),Object(re.jsx)(ve.a,{variant:"outlined",className:d.btn,onClick:function(){return u(t.addressId)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"})]}),Object(re.jsx)(me.a,{ref:s,className:d.clientsList,container:!0,spacing:3,children:t.clients.map((function(e){return Object(re.jsx)(me.a,{item:!0,xs:12,sm:12,md:6,lg:4,xl:3,children:Object(re.jsxs)(he.a,{className:d.paper,children:[Object(re.jsx)("span",{className:d.itemDelete,onClick:function(){return l(e.bindId)},children:Object(re.jsx)(xe.a,{})}),Object(re.jsxs)(_.a,{children:[Object(re.jsxs)(L.a,{className:d.listItem,children:[Object(re.jsx)(T.a,{primary:"name:",className:d.key}),Object(re.jsx)(T.a,{primary:e.name,className:d.value})]}),Object(re.jsxs)(L.a,{className:d.listItem,children:[Object(re.jsx)(T.a,{primary:"phone:",className:d.key}),Object(re.jsx)(T.a,{primary:e.phone,className:d.value})]}),Object(re.jsxs)(L.a,{className:d.listItem,children:[Object(re.jsx)(T.a,{primary:"e-mail:",className:d.key}),Object(re.jsx)(T.a,{primary:e.email,className:d.value})]})]})]})},e.id)}))})]})]}):null})),Le=function(e){return function(t){var n=Object(E.c)((function(e){return e})),a=n.options.menuOpen,r=n.housing,i=r.data,c=r.loading,s=Object(E.b)(),u=Object(o.a)(Object(o.a)({},t),{},{menuOpen:a,data:i,loading:c,chooseFlat:function(e){s({type:y,payload:e})}});return Object(re.jsx)(e,Object(o.a)({},u))}}((function(e){var t=e.menuOpen,n=e.data,a=e.loading,r=e.chooseFlat,i=se();return Object(re.jsxs)("main",{className:Object(oe.a)(i.content,Object(ce.a)({},i.contentShift,t)),children:[Object(re.jsx)("div",{className:F().root}),Object(re.jsx)(ue.a,{className:i.backdrop,open:a,children:Object(re.jsx)(M.a,{color:"inherit"})}),Object(re.jsxs)("div",{className:i.contentWrapper,children:[Object(re.jsx)(le.a,{className:i.tree,defaultExpanded:["0"],defaultCollapseIcon:Object(re.jsx)(pe.a,{}),defaultExpandIcon:Object(re.jsx)(be.a,{}),children:n&&n.length>0&&function e(t){return t.map((function(t){return t.child?Object(re.jsx)(fe.a,{nodeId:t.name+t.id+"_"+t.parent,label:t.name,children:e(t.child)},t.name+t.id+"_"+t.parent):Object(re.jsx)(fe.a,{nodeId:t.name+t.id+"_"+t.parent,label:t.name,onClick:function(){return r(t.addressId)}},t.name+t.id+"_"+t.parent)}))}(n)}),Object(re.jsx)(_e,{})]})]})})),Te=n(190),Ae=n(191),Pe=n(62),Be=n(91),He=n.n(Be),Re=Object(U.a)((function(e){return{appBar:{background:"#343a40",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(D,"px)"),marginLeft:D,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"}}})),Ue=function(e){return function(t){var n=Object(E.b)(),r=Object(E.c)((function(e){return e})),i=r.options,c=i.menuOpen,s=i.curCompany,u=r.companies.data,l=Object(a.useMemo)((function(){var e=u.filter((function(e){return e.id===s}));return(e=e[0])?e.name:"React App"}),[s]),d=Object(o.a)(Object(o.a)({},t),{},{menuOpen:c,companyName:l,handleDrawerOpen:function(){n(ae(!0))}});return Object(re.jsx)(e,Object(o.a)({},d))}}((function(e){var t=e.menuOpen,n=e.companyName,a=e.handleDrawerOpen,r=Re();return Object(re.jsx)(Te.a,{position:"fixed",className:Object(oe.a)(r.appBar,Object(ce.a)({},r.appBarShift,t)),children:Object(re.jsxs)(Ae.a,{children:[Object(re.jsx)(A.a,{color:"inherit","aria-label":"open drawer",onClick:a,edge:"start",className:Object(oe.a)(r.menuButton,t&&r.hide),children:Object(re.jsx)(He.a,{})}),Object(re.jsx)(Pe.a,{variant:"h6",noWrap:!0,children:n})]})})})),We=function(){var e=W();return Object(re.jsxs)("div",{className:e.root,children:[Object(re.jsx)(Ue,{}),Object(re.jsx)(ie,{}),Object(re.jsx)(Le,{})]})},De=(n(137),n(192));i.a.render(Object(re.jsxs)(E.a,{store:k,children:[Object(re.jsx)(De.a,{}),Object(re.jsx)(We,{})]}),document.getElementById("root"))}},[[138,1,2]]]);
//# sourceMappingURL=main.235780d4.chunk.js.map